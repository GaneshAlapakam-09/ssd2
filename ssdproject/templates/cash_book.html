<!DOCTYPE html>
<html>
<head>

	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="description" content="Materia - Admin Template">
	<meta name="keywords" content="materia, webapp, admin, dashboard, template, ui">
	<meta name="author" content="solutionportal">
	<!-- <base href="/"> -->

	<title>SSD</title>
	
	{% load static %}
	<link rel="icon" type="image/x-icon" href="{% static 'images/SS_LOGO.webp' %}">

<!-- Font Styles -->
<link rel="stylesheet" href="{% static 'fonts/font-awesome/css/font-awesome.min.css' %}">
<link rel="stylesheet" href="{% static 'fonts/ionicons/css/ionicons.min.css' %}">

<!-- Plugins -->
<link rel="stylesheet" href="{% static 'styles/plugins/c3.css' %}">
<link rel="stylesheet" href="{% static 'styles/plugins/waves.css' %}">
<link rel="stylesheet" href="{% static 'styles/plugins/perfect_scrollbar.css' %}">

<!-- CSS Stylesheets -->
<link rel="stylesheet" href="{% static 'styles/bootstrap.min.css' %}">
<link rel="stylesheet" href="{% static 'styles/main.min.css' %}">


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/fontawesome.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">



	<!-- Plugins -->
	<link rel="stylesheet" href="{% static 'styles/plugins/waves.css' %}">
	<link rel="stylesheet" href="{% static 'styles/plugins/perfect-scrollbar.css' %}">
	<link rel="stylesheet" href="{% static 'styles/plugins/select2.css' %}">
	<link rel="stylesheet" href="{% static 'styles/plugins/bootstrap-colorpicker.css' %}">
	<link rel="stylesheet" href="{% static 'styles/plugins/bootstrap-slider.css' %}">
	<link rel="stylesheet" href="{% static 'styles/plugins/bootstrap-datepicker.css' %}">
	<link rel="stylesheet" href="{% static 'styles/plugins/summernote.css' %}">



<style>
	.out-standing{
		margin:0px
	}

	.addpays{
		display:flex;
		justify-content:center;
	}
	.addpays #sendData{
		margin-top:30px;
	}

	
	
	.logo-container {
			position: relative;
			width: fit-content;
			text-align: center;
			padding: 20px;
		  }
		  
		  
		  
		  .logo-text {
			display: flex;
			align-items: center;
			position: relative;
			z-index: 2;
		  }
		  
		  .ss {
			font-family: fantasy;
			color: red;
			font-size: 80px;
			font-weight: 100;
			line-height: 1;
		  }
		  
		  .digital {
			font-family: fantasy;
			color: green;
			font-size: 80px;
			font-weight: 100;
			text-shadow: 2px 2px 0 #fff, -2px 2px 0 #fff, 2px -2px 0 #fff, -2px -2px 0 #fff;
			margin-top: -10px;
		  }

        .dropdown.category {
			width: 100%;
			/* Full width */
			padding: 10px;
			font-size: 16px;
			border: 2px solid #ccc;
			border-radius: 0px;
			background-color: #fff;
			cursor: pointer;
			outline: none;
			transition: border-color 0.3s, box-shadow 0.3s;
		}

		/* Focus effect */
		.dropdown.category:focus {
			border-color: #007bff;
			box-shadow: 0 0 5px rgba(0, 123, 255, 0.5);
		}

		/* Disabled option */
		.dropdown.category option:disabled {
			color: #aaa;
		}

		/* Hover effect */
		.dropdown.category:hover {
			border-color: #0056b3;
		}

		/* Custom styling for when dropdown is open */
		.dropdown.category:active,
		.dropdown.category:focus-within {
			background-color: #f9f9f9;
		}

          /* Style the autocomplete dropdown */
        .autocomplete-items {
            position: absolute;
            border: 1px solid #ddd;
            border-radius: 5px;
            max-height: 200px;
            overflow-y: auto;
            background-color: #fff;
            z-index: 99;
            width: 500px;
        }
        .autocomplete-items div {
            padding: 10px;
            cursor: pointer;
        }
        .autocomplete-items div:hover {
            background-color: #f1f1f1;
        }
		  
	</style>





<link href="https://unpkg.com/ionicons@4.5.10-0/dist/css/ionicons.min.css" rel="stylesheet">
 	<link href='http://fonts.googleapis.com/css?family=Roboto:400,500,700,300' rel='stylesheet' type='text/css'>

	<!-- Match Media polyfill for IE9 -->
	<!--[if IE 9]> <script src="scripts/ie/matchMedia.js"></script>  <![endif]--> 

	
</head>
<body id="app" class="app off-canvas">
	<div id="preloader">
		<h1 class="dash-cont loa"> <span class="ss">SS</span> <span class="digital">digital</span></h1>
	</div>
	
	<!-- header -->
	<header class="site-head" id="site-head">
		<ul class="list-unstyled left-elems">
			<!-- nav trigger/collapse -->
			<li>
				<a href="javascript:;" class="nav-trigger icon ion-md-menu"></a>
			</li>
			<!-- #end nav-trigger -->

			<!-- site-logo for mobile nav -->
			<li>
				<div class="site-logo visible-xs">
					<a href="javascript:;" class="text-uppercase h3">
						<span class="text">SSD</span>
					</a>
				</div>
			</li> <!-- #end site-logo -->


			
		</ul>
        <ul class="list-unstyled right-elems">
			<!-- profile drop -->
			<li class="profile-drop hidden-xs dropdown">
				<a href="javascript:;" data-toggle="dropdown">
					<img src="{% static 'images/user.png' %}" alt="admin-pic">
				</a>
				<ul class="dropdown-menu dropdown-menu-right">
					<li><a href="{% url "signout" %}"><span class="ion ion-md-exit">&nbsp;&nbsp;</span>Logout</a></li>
				</ul>
			</li>
			<!-- #end profile-drop -->

			

		</ul>

		<ul class="list-unstyled right-elems">
			


		</ul>

	
	</header>
	<!-- #end header -->

	<!-- main-container -->
	<div class="main-container clearfix">
		<!-- main-navigation -->
		 
		<aside class="nav-wrap" id="site-nav" data-perfect-scrollbar>
            <div class="nav-head">
                <!-- site logo -->
                <a href="{% url 'dashboard' %}" class="site-logo text-uppercase">
                    {% comment %} <i class="ion ion-disc"></i> {% endcomment %}
                    <img src="{% static 'images/SS_LOGO.webp' %}" alt="">
                    <span class="text">SS Digital</span>
                </a>
            </div>

            <!-- Site nav (vertical) -->

            <nav class="site-nav clearfix" role="navigation">


                <!-- navigation -->
                <ul class="list-unstyled clearfix nav-list mb15">
                    <li class="active">
                        <a href="{% url 'dashboard' %}">
                            <i class="ion ion-monitor"></i>
                            <span class="text">Dashboard</span>
                        </a>
                    </li>
                    {% comment %} <li>
                        <a>
                            <i class="icon ion-md-people"></i>
                            <span class="text">Customer Management</span>
                        </a>
                    </li> {% endcomment %}
                    <li>
                        <a href="javascript:;">
                            <i class="icon ion-md-people"></i>
                            <span class="text">Customer Management</span>
                            {% comment %} <i class="icon ion-md-arrow"></i> {% endcomment %}
                        </a>
                        <ul class="inner-drop list-unstyled">
                            <li><a href="{% url 'addcustomer' %}">Add Customer</a></li>
                            <li><a href="{% url 'listcustomer' %}">List Customer</a></li>
                        </ul>
                    </li>
                    {% if user.role == 'admin' %}
                    <li>
                        <a href="javascript:;">
                            <i class="icon ion-md-contact"></i>
                            <span class="text">Employee Management</span>
                            {% comment %} <i class="icon ion-md-arrow"></i> {% endcomment %}
                        </a>
                        <ul class="inner-drop list-unstyled">
                            <li><a href="{% url 'addemployee' %}">Add Employee</a></li>
                            <li><a href="{% url 'listemployee' %}">List Employee</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="javascript:;">
                            <i class="icon ion-md-cube"></i>
                            <span class="text">Material Management</span>
                            {% comment %} <i class="icon ion-md-arrow"></i> {% endcomment %}
                        </a>
                        <ul class="inner-drop list-unstyled">
                            <li><a href="{% url 'addmaterial' %}">Add Material</a></li>
                            <li><a href="{% url 'listmaterial' %}">List Material</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="javascript:;">
                            <i class="icon ion-logo-dropbox"></i>
                            <span class="text">Inward Management</span>
                            {% comment %} <i class="icon ion-md-arrow"></i> {% endcomment %}
                        </a>
                        <ul class="inner-drop list-unstyled">
                            <li><a href="{% url 'select_material' %}">Add Inward</a></li>
                            <li><a href="{% url 'listinward' %}">List Inward</a></li>
                            <li><a href="{% url 'listoutward' %}">List Outward</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="javascript:;">
                            <i class="icon ion-md-albums"></i>
                            <span class="text">Product Management</span>
                            {% comment %} <i class="icon ion-md-arrow"></i> {% endcomment %}
                        </a>
                        <ul class="inner-drop list-unstyled">
                            <li><a href="{% url 'addproduct' %}">Add Product</a></li>
                            <li><a href="{% url 'listproduct' %}">List Product</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="javascript:;">
                            <i class="icon ion-md-apps"></i>
                            <span class="text">Category Management</span>
                            {% comment %} <i class="icon ion-md-arrow"></i> {% endcomment %}
                        </a>
                        <ul class="inner-drop list-unstyled">
                            <li><a href="{% url 'addcategories' %}">Add Category</a></li>
                            <li><a href="{% url 'listcategories' %}">List Category</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="javascript:;">
                            <i class="icon ion-md-pricetag"></i>
                            <span class="text">Cost Management</span>
                            {% comment %} <i class="icon ion-md-pricetag"></i> {% endcomment %}
                        </a>
                        <ul class="inner-drop list-unstyled">
                            <li><a href="{% url 'addcost' %}">Add Cost</a></li>
                            <li><a href="{% url 'listcost' %}">List Cost</a></li>
                        </ul>
                    </li>
                    {% endif %}


                    <li>
                        <a href="javascript:;">
                            <i class="icon ion-md-paper"></i>
                            <span class="text">Billing Management</span>
                            {% comment %} <i class="icon ion-md-arrow"></i> {% endcomment %}
                        </a>
                        <ul class="inner-drop list-unstyled">
                            <li><a href="{% url 'bill' %}">Add Bill</a></li>
                            <li><a href="{% url 'listbill' %}">List Bill</a></li>
                            <li><a href="{% url 'listquote' %}">List Quotation</a></li>
                            <li><a href="{% url 'listestimate' %}">List Estimation</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="javascript:;">
                            <i class="icon ion-md-cash"></i>
                            <span class="text">Payment Management</span>
                            {% comment %} <i class="icon ion-md-arrow"></i> {% endcomment %}
                        </a>
                        <ul class="inner-drop list-unstyled">
                            <li><a href="{% url 'filtered_data' 'all' %}">Overall</a></li>
                            <li><a href="{% url 'filtered_data' 'today' %}">Today</a></li>
                            <li><a href="{% url 'filtered_data' 'this_week' %}">This Week</a></li>
                            <li><a href="{% url 'filtered_data' 'this_month' %}">This Month</a></li>
                            <li><a href="{% url 'filtered_data' 'this_year' %}">This Year</a></li>
                            <li><a href="{% url 'outstanding'  %}">Outstanting Bills</a></li>
                        </ul>
                    </li>

					<li>
                        <a href="javascript:;">
                            <i class="icon ion-md-wallet"></i>
                            <span class="text">Cash Book</span>
                            {% comment %} <i class="icon ion-md-arrow"></i> {% endcomment %}
                        </a>
                        <ul class="inner-drop list-unstyled">
                            <li><a href="{% url 'loadcash' %}">Load Cash</a></li>
                            <li><a href="{% url 'cashbook' %}">Add Expences</a></li>
                            <li><a href="{% url 'listcashbook' %}">List Expenses</a></li>
                        </ul>
                    </li>



                </ul> <!-- #end navigation -->
            </nav>


        </aside>
		<!-- #end main-navigation -->

		<div class="content-container fixedHeader nav-expand">
         
           <!-- col-left -->

           <!-- Selects -->
						<div class="col-sm-12 col-md-11">
							<div class="panel-heading addbill-heading">
								<div><a class="btn btn-primary mr5" href="{% url "listbill" %}">List Bill</a> <a class="btn btn-primary mr5" href="{% url "loadcash" %}">Load Amount</a></div>
							</div>
							<div class="panel panel-default mb20">
								<div class="row">
									<div class=" col-md-6">
										<div class="panel-body">
											{% comment %} <h3>BILL No. : <span id="paymentId">{{new_pay_id}}</span></h3> {% endcomment %}
											<h3>Available Amount : ₹<span id="availbleAmount">{{cash_in_hand}}</span></h3>
											{% comment %} <h3>Pending Amount : ₹<span id="actualPending">{% if data.Payment_Id %}{{data.Pending_Amount}}{% else  %}{{data.Grand_Total}}{% endif %}</span></h3> {% endcomment %}

										</div>
									</div>
								</div>
								<div class="col-md-6">
									
								</div>
							</div>
							<div class="panel panel-default panel-hovered panel-stacked mb30">
								<div class="panel-heading">Payments</div>
								<div class="panel-body">
									<form role="form" id="paymentform">
										{% csrf_token %}
										<div>
		
											
											<div class="form-group">
                                                <label class="control-label small">Expense</label>
                                                <input type="text" id="search" placeholder="Search here.." class="form-control" autocomplete="off" />
                                                <div id="autocomplete-list" class="autocomplete-items"></div>
											</div>

                                            

											<!-- Category -->
											<div class="form-group">
												<label class="control-label small">Category</label>
												<select id="category" class="dropdown category" style="width: 100%" data-placeholder="Select Payment Method">
													<option>Select Category</option>	<!-- empty, for placeholder -->
                                                    <option value="Refershment">Refreshment</option>
                                                    <option value="Office Expences">Office Expences</option>
                                                    <option value="Drawings">Drawings</option>
                                                    <option value="Porter">Porter</option>
                                                    <option value="Traveling">Traveling</option>
                                                    {% comment %} {% for item in category %}
													    <option value="{{item.Category}}">{{item.Category}}</option>                                                    
                                                    {% endfor %} {% endcomment %}
												</select>
											</div>

											<!-- Amount -->
											<div class="form-group">
												<label class="control-label small">Amount</label>
                                                <input type="number" class="form-control" id="amount" name="amount" placeholder="Amount">
											</div>

                                            <!-- Payment Mode -->
											<div class="form-group">
												<label class="control-label small">Mode Of Payment</label>
												<select id="paymentMode" class="dropdown category">
													<option>Select Payment Mode</option>	<!-- empty, for placeholder -->
													<option value="CASH">Cash</option>
													<option value="UPI">UPI</option>
												</select>
											</div>


											<!-- Remarks -->
											<div class="form-group">
												<label class="control-label small">Remarks</label>
                                                <textarea name="remarks" id="remarks" class="form-control" placeholder="Remarks"></textarea>
											</div>

										</div>

									</form>
									<div class="addpays">
										<button id="addEntryBtn" class="btn-primary">Add Payment</button>
									</div>
								</div>
							</div>

							

							<div class="panel">
								<!-- Data Table -->
								
								<!-- #End Data Table -->

								<table class="table table-bordered table-striped table-responsive" id="entriesTable">
									<thead>
										<tr>
											<th>
												Expences
												<div class="th">
													<i class="fa fa-caret-up icon-up"></i>
													<i class="fa fa-caret-down icon-down"></i>
												</div>
											</th>
											
											<th>
												Expence Category
												<div class="th">
													<i class="fa fa-caret-up icon-up"></i>
													<i class="fa fa-caret-down icon-down"></i>
												</div>
											</th>

											<th>
												Payment Mode
												<div class="th">
													<i class="fa fa-caret-up icon-up"></i>
													<i class="fa fa-caret-down icon-down"></i>
												</div>
											</th>

											<th>
												Amount
												<div class="th">
													<i class="fa fa-caret-up icon-up"></i>
													<i class="fa fa-caret-down icon-down"></i>
												</div>
											</th>
											<th>
												Remarks
												<div class="th">
													<i class="fa fa-caret-up icon-up"></i>
													<i class="fa fa-caret-down icon-down"></i>
												</div>
											</th>
											
											<th>
												Action
												<div class="th">
													<i class="fa fa-caret-up icon-up"></i>
													<i class="fa fa-caret-down icon-down"></i>
												</div>
											</th>
										</tr>
									</thead>
									<tbody>
										<!-- Data initializes via script, can also be loaded via AJAX -->
									</tbody>
								</table>
                                {% comment %} <h3 id = "totalAmountDisplay">Total Amount</h3> {% endcomment %}
							</div>
							<div class="addpays">
								<button id="sendData" class="btn-tag-primary">Submit The Payments</button>
							</div>

							
						</div>
			
						

				
			</div> <!-- #end col-left -->


		</div>


		<!-- content-here -->
		<div class="content-container" id="content">
			<!-- dashboard page -->
			<div class="page page-dashboard">

				<div class="page-wrap">


					

				</div> <!-- #end page-wrap -->
			</div>
			<!-- #end dashboard page -->
		</div>

		
	</div> <!-- #end main-container -->
	

	<!-- theme settings -->
	<div class="site-settings clearfix hidden-xs" >
		<div class="settings clearfix">
			<div class="trigger ion ion-settings left"></div>
			<div class="wrapper left">
				<ul class="list-unstyled other-settings">
					<li class="clearfix mb10">
						<div class="left small">Nav Horizontal</div>
						<div class="md-switch right">
							<label>
								<input type="checkbox" id="navHorizontal"> 
								<span>&nbsp;</span> 
							</label>
						</div>
						
						
					</li>
					<li class="clearfix mb10">
						<div class="left small">Fixed Header</div>
						<div class="md-switch right">
							<label>
								<input type="checkbox"  id="fixedHeader"> 
								<span>&nbsp;</span> 
							</label>
						</div>
					</li>
					<li class="clearfix mb10">
						<div class="left small">Nav Full</div>
						<div class="md-switch right">
							<label>
								<input type="checkbox"  id="navFull"> 
								<span>&nbsp;</span> 
							</label>
						</div>
					</li>
				</ul>
				<hr/>
				<ul class="themes list-unstyled" id="themeColor">
					<li data-theme="theme-zero"></li>
					<li data-theme="theme-one"></li>
					<li data-theme="theme-two"></li>
					<li data-theme="theme-three" class="active"></li>
					<li data-theme="theme-four"></li>
					<li data-theme="theme-five"></li>
					<li data-theme="theme-six"></li>
					<li data-theme="theme-seven"></li>
				</ul>
			</div>
		</div>
	</div>
	<!-- #end theme settings -->


	

	<!-- Dev only -->
	<!-- Vendors -->
	{% load static %}


<script src="{% static 'scripts/vendors.js' %}"></script>
<script src="{% static 'scripts/plugins/screenfull.js' %}"></script>
<script src="{% static 'scripts/plugins/perfect-scrollbar.min.js' %}"></script>
<script src="{% static 'scripts/plugins/waves.min.js' %}"></script>
<script src="{% static 'scripts/plugins/select2.min.js' %}"></script>
<script src="{% static 'scripts/plugins/bootstrap-colorpicker.min.js' %}"></script>
<script src="{% static 'scripts/plugins/bootstrap-slider.min.js' %}"></script>
<script src="{% static 'scripts/plugins/summernote.min.js' %}"></script>
<script src="{% static 'scripts/plugins/bootstrap-datepicker.min.js' %}"></script>
<script src="{% static 'scripts/app.js' %}"></script>
{% comment %} <script src="{% static 'scripts/form-elements.init.js' %}"></script> {% endcomment %}



<!-- Scripts -->
{% comment %} <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script> {% endcomment %}
{% comment %} <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.min.js"></script> {% endcomment %}


 <script>
        document.addEventListener("DOMContentLoaded", function () {
            //Sample data (you will replace this with Django dynamic data)
            var customerData = [
                {% for item in category %}
                    "{{item.Expense_Name}}",
                {% endfor %}
            ];


            var input = document.getElementById("search");
            var autocompleteList = document.getElementById("autocomplete-list");

            input.addEventListener("input", function () {
                var val = this.value;
                autocompleteList.innerHTML = ""; // Clear previous results

                if (!val) return; // Stop if input is empty

                customerData.forEach(function (item) {
                    if (item.toLowerCase().includes(val.toLowerCase())) {
                        var suggestion = document.createElement("div");
                        suggestion.textContent = item;
                        suggestion.addEventListener("click", function () {
                            input.value = item; // Set input value on selection
                            autocompleteList.innerHTML = ""; // Hide dropdown
                        });
                        autocompleteList.appendChild(suggestion);
                    }
                });
            });

            document.addEventListener("click", function (e) {
                if (!input.contains(e.target) && !autocompleteList.contains(e.target)) {
                    autocompleteList.innerHTML = ""; // Hide dropdown when clicking outside
                }
            });
        });
</script>


<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Initialize variables
        let entries = [];
        const availableAmount = parseFloat(document.getElementById('availbleAmount').textContent) || 0;

        // Add entry button click handler
        document.getElementById('addEntryBtn').addEventListener('click', function () {
            const expense = document.getElementById('search').value.trim();
            const category = document.getElementById('category').value;
            const amount = parseFloat(document.getElementById('amount').value) || 0;
            const paymentMode = document.getElementById('paymentMode').value;
            const remarks = document.getElementById('remarks').value.trim();

            if (!expense || !category || amount <= 0 || !paymentMode) {
                alert('Please fill all required fields with valid values');
                return;
            }

            const currentTotal = entries.reduce((sum, entry) => sum + entry.amount, 0);
            const newTotal = currentTotal + amount;

            if (newTotal > availableAmount) {
                alert(`Total amount (₹${newTotal}) exceeds available amount (₹${availableAmount})`);
                return;
            }

            const newEntry = {
                expense,
                category,
                amount,
                paymentMode,
                remarks,
                id: Date.now()
            };
            entries.push(newEntry);
            updateTable();

           document.getElementById('paymentform').reset();

        });

        // Update table function
        function updateTable() {
            const tbody = document.querySelector('#entriesTable tbody');
            tbody.innerHTML = '';

            let total = 0;

            entries.forEach(entry => {
                total += entry.amount;

                const row = document.createElement('tr');
                row.dataset.id = entry.id;

                row.innerHTML = `
                    <td>${entry.expense}</td>
                    <td>${entry.category}</td>
                    <td>${entry.paymentMode}</td>
                    <td>₹${entry.amount.toFixed(2)}</td>
                    <td>${entry.remarks}</td>
                    <td><button class="btn btn-sm btn-danger delete-entry">Delete</button></td>
                `;
                tbody.appendChild(row);
            });

            const totalDiv = document.getElementById('totalAmountDisplay');
            if (totalDiv) totalDiv.remove();

            const totalDisplay = document.createElement('div');
            totalDisplay.id = 'totalAmountDisplay';
            totalDisplay.className = 'alert alert-info';
            totalDisplay.innerHTML = `<strong>Total Amount:</strong> ₹${total.toFixed(2)} / ₹${availableAmount.toFixed(2)}`;

            document.getElementById('entriesTable').insertAdjacentElement('afterend', totalDisplay);
        }

        // Delete entry handler
        document.getElementById('entriesTable').addEventListener('click', function (e) {
            if (e.target && e.target.classList.contains('delete-entry')) {
                const row = e.target.closest('tr');
                const entryId = parseInt(row.dataset.id);
                entries = entries.filter(entry => entry.id !== entryId);
                updateTable();
            }
        });

        // Submit data handler
        document.getElementById('sendData').addEventListener('click', function () {
            if (entries.length === 0) {
                alert('Please add at least one entry before submitting');
                return;
            }

            const totalAmount = entries.reduce((sum, entry) => sum + entry.amount, 0);
            const csrfToken = document.querySelector('input[name="csrfmiddlewaretoken"]').value;

            const postData = new FormData();
            postData.append('entries', JSON.stringify(entries));
            postData.append('total_amount', totalAmount);
            postData.append('available_amount', availableAmount);
            postData.append('csrfmiddlewaretoken', csrfToken);

            fetch(window.location.href, {
                method: 'POST',
                body: postData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert('Data submitted successfully!');
                    entries = [];
                    updateTable();
                    // Optionally update availableAmount if server responds with a new value
                    // document.getElementById('availbleAmount').textContent = data.new_available_amount;
                } else {
                    alert('Error: ' + (data.message || 'Submission failed'));
                }
            })
            .catch(error => {
                alert('Error submitting data: ' + error);
            });
        });
    });
</script>

<script>
    window.addEventListener("load", function () {
        const preloader = document.getElementById("preloader");
        preloader.style.opacity = "0";
        setTimeout(() => preloader.style.display = "none", 500);
    });
</script>
	
</body>
</html>
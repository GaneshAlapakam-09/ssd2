<!DOCTYPE html>
<html>

<head>

	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="description" content="Materia - Admin Template">
	<meta name="keywords" content="materia, webapp, admin, dashboard, template, ui">
	<meta name="author" content="solutionportal">
	<!-- <base href="/"> -->

	<title>SSD</title>

	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

	{% load static %}
	<link rel="icon" type="image/x-icon" href="{% static 'images/SS_LOGO.webp' %}">

	<!-- Icons -->
	<link rel="stylesheet" href="{% static 'fonts/ionicons/css/ionicons.min.css' %}">
	<link rel="stylesheet" href="{% static 'fonts/font-awesome/css/font-awesome.min.css' %}">

	<!-- Plugins -->
	<link rel="stylesheet" href="{% static 'styles/plugins/waves.css' %}">
	<link rel="stylesheet" href="{% static 'styles/plugins/perfect-scrollbar.css' %}">

	<!-- CSS Stylesheets -->
	<link rel="stylesheet" href="{% static 'styles/bootstrap.min.css' %}">
	<link rel="stylesheet" href="{% static 'styles/main.min.css' %}">






	<link href="https://unpkg.com/ionicons@4.5.10-0/dist/css/ionicons.min.css" rel="stylesheet">
	<link href='http://fonts.googleapis.com/css?family=Roboto:400,500,700,300' rel='stylesheet' type='text/css'>

	<!-- Match Media polyfill for IE9 -->
	<!--[if IE 9]> <script src="scripts/ie/matchMedia.js"></script>  <![endif]-->


	<style>
		.panel-heading.addbill-heading {
			display: flex;
			justify-content: space-between;
			align-items: center;
		}

		.logo-container {
			position: relative;
			width: fit-content;
			text-align: center;
			padding: 20px;
		}



		.logo-text {
			display: flex;
			align-items: center;
			position: relative;
			z-index: 2;
		}

		.ss {
			font-family: fantasy;
			color: red;
			font-size: 80px;
			font-weight: 100;
			line-height: 1;
		}

		.digital {
			font-family: fantasy;
			color: green;
			font-size: 80px;
			font-weight: 100;
			text-shadow: 2px 2px 0 #fff, -2px 2px 0 #fff, 2px -2px 0 #fff, -2px -2px 0 #fff;
			margin-top: -10px;
		}

		.totals-section {
			padding: 10px;
			display: grid;
			grid-template-columns: repeat(4, 1fr);
			gap: 16px;
			margin-top: 20px;
			font-size: 16px;
		}

		.totals-section h3 {
			background: #f8f8f8;
			padding: 12px;
			border-radius: 8px;
			box-shadow: 0 0 4px rgba(0, 0, 0, 0.1);
			margin: 0;
			font-weight: normal;
		}

		.totals-section h3 strong {
			color: #333;
		}

		@media print {
			.totals-section h3 {
				background: none;
				box-shadow: none;
			}
		}
	</style>


</head>

<body id="app" class="app off-canvas">
	<div id="preloader">
		<h1 class="dash-cont loa"> <span class="ss">SS</span> <span class="digital">digital</span></h1>
	</div>

	<!-- header -->
	<header class="site-head" id="site-head">
		<ul class="list-unstyled left-elems">
			<!-- nav trigger/collapse -->
			<li>
				<a href="javascript:;" class="nav-trigger icon ion-md-menu"></a>
			</li>
			<!-- #end nav-trigger -->

			<!-- site-logo for mobile nav -->
			<li>
				<div class="site-logo visible-xs">
					<a href="javascript:;" class="text-uppercase h3">
						<span class="text">SSD</span>
					</a>
				</div>
			</li> <!-- #end site-logo -->



		</ul>
		<ul class="list-unstyled right-elems">
			<!-- profile drop -->
			<li class="profile-drop hidden-xs dropdown">
				<a href="javascript:;" data-toggle="dropdown">
					<img src="{% static 'images/user.png' %}" alt="admin-pic">
				</a>
				<ul class="dropdown-menu dropdown-menu-right">
					<li><a href="{% url 'signout' %}"><span class="ion ion-md-exit">&nbsp;&nbsp;</span>Logout</a></li>
				</ul>
			</li>
			<!-- #end profile-drop -->



		</ul>

		<ul class="list-unstyled right-elems">



		</ul>


	</header>
	<!-- #end header -->

	<!-- main-container -->
	<div class="main-container clearfix">
		<!-- main-navigation -->

		<aside class="nav-wrap" id="site-nav" data-perfect-scrollbar>
            <div class="nav-head">
                <!-- site logo -->
                <a href="{% url 'dashboard' %}" class="site-logo text-uppercase">
                    {% comment %} <i class="ion ion-disc"></i> {% endcomment %}
                    <img src="{% static 'images/SS_LOGO.webp' %}" alt="">
                    <span class="text">SS Digital</span>
                </a>
            </div>

            <!-- Site nav (vertical) -->

            <nav class="site-nav clearfix" role="navigation">


                <!-- navigation -->
                <ul class="list-unstyled clearfix nav-list mb15">
                    <li class="active">
                        <a href="{% url 'dashboard' %}">
                            <i class="ion ion-monitor"></i>
                            <span class="text">Dashboard</span>
                        </a>
                    </li>
                    {% comment %} <li>
                        <a>
                            <i class="icon ion-md-people"></i>
                            <span class="text">Customer Management</span>
                        </a>
                    </li> {% endcomment %}
                    <li>
                        <a href="javascript:;">
                            <i class="icon ion-md-people"></i>
                            <span class="text">Customer Management</span>
                            {% comment %} <i class="icon ion-md-arrow"></i> {% endcomment %}
                        </a>
                        <ul class="inner-drop list-unstyled">
                            <li><a href="{% url 'addcustomer' %}">Add Customer</a></li>
                            <li><a href="{% url 'listcustomer' %}">List Customer</a></li>
                        </ul>
                    </li>
                    {% if user.role == 'admin' %}
                    <li>
                        <a href="javascript:;">
                            <i class="icon ion-md-contact"></i>
                            <span class="text">Employee Management</span>
                            {% comment %} <i class="icon ion-md-arrow"></i> {% endcomment %}
                        </a>
                        <ul class="inner-drop list-unstyled">
                            <li><a href="{% url 'addemployee' %}">Add Employee</a></li>
                            <li><a href="{% url 'listemployee' %}">List Employee</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="javascript:;">
                            <i class="icon ion-md-cube"></i>
                            <span class="text">Material Management</span>
                            {% comment %} <i class="icon ion-md-arrow"></i> {% endcomment %}
                        </a>
                        <ul class="inner-drop list-unstyled">
                            <li><a href="{% url 'addmaterial' %}">Add Material</a></li>
                            <li><a href="{% url 'listmaterial' %}">List Material</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="javascript:;">
                            <i class="icon ion-logo-dropbox"></i>
                            <span class="text">Inward Management</span>
                            {% comment %} <i class="icon ion-md-arrow"></i> {% endcomment %}
                        </a>
                        <ul class="inner-drop list-unstyled">
                            <li><a href="{% url 'select_material' %}">Add Inward</a></li>
                            <li><a href="{% url 'listinward' %}">List Inward</a></li>
                            <li><a href="{% url 'listoutward' %}">List Outward</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="javascript:;">
                            <i class="icon ion-md-albums"></i>
                            <span class="text">Product Management</span>
                            {% comment %} <i class="icon ion-md-arrow"></i> {% endcomment %}
                        </a>
                        <ul class="inner-drop list-unstyled">
                            <li><a href="{% url 'addproduct' %}">Add Product</a></li>
                            <li><a href="{% url 'listproduct' %}">List Product</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="javascript:;">
                            <i class="icon ion-md-apps"></i>
                            <span class="text">Category Management</span>
                            {% comment %} <i class="icon ion-md-arrow"></i> {% endcomment %}
                        </a>
                        <ul class="inner-drop list-unstyled">
                            <li><a href="{% url 'addcategories' %}">Add Category</a></li>
                            <li><a href="{% url 'listcategories' %}">List Category</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="javascript:;">
                            <i class="icon ion-md-pricetag"></i>
                            <span class="text">Cost Management</span>
                            {% comment %} <i class="icon ion-md-pricetag"></i> {% endcomment %}
                        </a>
                        <ul class="inner-drop list-unstyled">
                            <li><a href="{% url 'addcost' %}">Add Cost</a></li>
                            <li><a href="{% url 'listcost' %}">List Cost</a></li>
                        </ul>
                    </li>
                    {% endif %}


                    <li>
                        <a href="javascript:;">
                            <i class="icon ion-md-paper"></i>
                            <span class="text">Billing Management</span>
                            {% comment %} <i class="icon ion-md-arrow"></i> {% endcomment %}
                        </a>
                        <ul class="inner-drop list-unstyled">
                            <li><a href="{% url 'bill' %}">Add Bill</a></li>
                            <li><a href="{% url 'listbill' %}">List Bill</a></li>
                            <li><a href="{% url 'listquote' %}">List Quotation</a></li>
                             
                        </ul>
                    </li>
                    <li>
                        <a href="javascript:;">
                            <i class="icon ion-md-cash"></i>
                            <span class="text">Payment Management</span>
                            {% comment %} <i class="icon ion-md-arrow"></i> {% endcomment %}
                        </a>
                        <ul class="inner-drop list-unstyled">
                            <li><a href="{% url 'filtered_data' 'all' %}">Overall</a></li>
                            <li><a href="{% url 'filtered_data' 'today' %}">Today</a></li>
                            <li><a href="{% url 'filtered_data' 'this_week' %}">This Week</a></li>
                            <li><a href="{% url 'filtered_data' 'this_month' %}">This Month</a></li>
                            <li><a href="{% url 'filtered_data' 'this_year' %}">This Year</a></li>
                            <li><a href="{% url 'outstanding'  %}">Outstanting Bills</a></li>
                        </ul>
                    </li>

					<li>
                        <a href="javascript:;">
                            <i class="icon ion-md-wallet"></i>
                            <span class="text">Cash Book</span>
                            {% comment %} <i class="icon ion-md-arrow"></i> {% endcomment %}
                        </a>
                        <ul class="inner-drop list-unstyled">
                            <li><a href="{% url 'loadcash' %}">Load Cash</a></li>
                            <li><a href="{% url 'cashbook' %}">Add Expences</a></li>
                            <li><a href="{% url 'listcashbook' %}">List Expenses</a></li>
                        </ul>
                    </li>



                </ul> <!-- #end navigation -->
            </nav>


        </aside>
		<!-- #end main-navigation -->

		<div class="content-container fixedHeader nav-expand">
			<!-- Data Table -->
			<div class="col-md-11">
				<div class="panel panel-lined table-responsive panel-hovered mb20 data-table"
					style="padding-bottom: 20px">

					<div class="panel-heading addbill-heading">
						<div>
							<div class="panel-heading">Payment List</div>
						</div>
						<div>
							<a class="btn btn-primary mr5" href="{% url 'listbill' %}">List Bill</a>
							<button id="printTable" class="btn btn-primary mr5 waves-effect">Print Table</button>
						</div>
					</div>
					<div class="panel-body">
						<div class="small text-bold left mt5">
							Show&nbsp;
							<select class="lengthSelect">
								<option value="5">5</option>
								<option value="10" selected>10</option>
								<option value="20">20</option>
								<option value="50">50</option>
							</select>
							&nbsp;entries
						</div>

						<form class="form-horizontal right col-lg-4" action="javascript:;">
							<input type="text" class="form-control input-sm searchInput" placeholder="Type keyword">
						</form>
					</div>
					<!-- data table -->
					<table class="table table-bordered table-striped">
						<thead>
							<tr>
								<th>
									Bill Id

								</th>
								<th>
									Customer Id

								</th>
								<th>
									Name

								</th>
								<th>
									Payment Mode

								</th>

								<th>
									Bill Amount

								</th>
								<th>
									Advance

								</th>
								<th>
									Pending Amount

								</th>

								<th>
									Collected By

								</th>

								<th>
									Date

								</th>
							</tr>
						</thead>
						<tbody>
							<!-- data initialize via script, can also be load via ajax -->
						</tbody>
					</table>


					{% comment %} <div class="totals-section">
						<h3><strong>Total :</strong> ₹<span id="total-grand">{{grand_total}}</span></h3>
						<h3><strong>Paid :</strong> ₹<span id="total-paid">{{paid_amount}}</span></h3>
						<h3><strong>Pending :</strong> ₹<span id="total-pending">{{pending_amount}}</span></h3>
						<h3><strong>UPI :</strong> ₹<span id="paid-upi">0</span></h3>
						<h3><strong>Cash :</strong> ₹<span id="paid-cash">0</span></h3>
						<h3><strong>Discount :</strong> ₹<span id="paid-discount">0</span></h3>
						<h3><strong>Cheque :</strong> ₹<span id="paid-cheque">0</span></h3>
						<h3><strong>IMPS/NIFT :</strong> ₹<span id="paid-IMPS">0</span></h3>
					</div> {% endcomment %}

					{% comment %} <h2><strong>Total Business</strong></h2>
					<div class="totals-section">
						<h3><strong>Total :</strong> ₹<span id="total-grand">{{grand_total}}</span></h3>
						<h3><strong>Paid :</strong> ₹<span id="total-paid">{{paid_amount}}</span></h3>
						<h3><strong>Pending :</strong> ₹<span id="total-pending">{{pending_amount}}</span></h3>
					</div> {% endcomment %}

					<h2><strong>Total Collection</strong></h2>
					<div class="total-collection totals-section">
						<h3><strong>UPI :</strong> ₹<span id="paid-upi">0</span></h3>
						<h3><strong>Cash :</strong> ₹<span id="paid-cash">0</span></h3>
						<h3><strong>Discount :</strong> ₹<span id="paid-discount">0</span></h3>
						<h3><strong>Cheque :</strong> ₹<span id="paid-cheque">0</span></h3>
						<h3><strong>IMPS/NIFT :</strong> ₹<span id="paid-IMPS">0</span></h3>
					</div>




					<!-- #end data table -->

				</div>

				<div class="panel panel-lined table-responsive panel-hovered mb20" style="padding-bottom: 20px">
					<center><h1>{{data4}} Bills</h1></center>

					<table class="table table-bordered table-striped ">
						<thead>
							<tr>
								<th>
									Bill Id

								</th>
								<th>
									Customer Id

								</th>
								<th>
									Name

								</th>
								<th>
									Phone

								</th>

								<th>
									Bill Amount

								</th>
								<th>
									Advance

								</th>
								<th>
									Pending Amount

								</th>



								<th>
									Date

								</th>
							</tr>
						</thead>
						<tbody>
							{% for item  in data3 %}
							<tr>
								<td>{{item.Bill_Id}}</td>
								{% if item.Customer_Id %}
								   <td>{{item.Customer_Id}}</td>
								{% else %}
								  <td>{{item.Agent_Id}}</td>
								{% endif %}
								<td>{{item.Customer_Name}}</td>
								<td>{{item.Phone_No}}</td>
								<td>{{item.Grand_Total}}</td>
								<td>{{item.Paid_Amount}}</td>
								<td>{{item.Pending_Amount}}</td>
								<td>{{item.Date}}</td>
							</tr>
							{% endfor %}
						</tbody>
					</table>

					<h2><strong>Total Business</strong></h2>
					<div class="totals-section total-business">
						<h3><strong>Total :</strong> ₹<span id="total-grand">{{grand_total}}</span></h3>
						<h3><strong>Paid :</strong> ₹<span id="total-paid">{{paid_amount}}</span></h3>
						<h3><strong>Pending :</strong> ₹<span id="total-pending">{{pending_amount}}</span></h3>
					</div>

				</div>

				<div class="panel panel-lined table-responsive panel-hovered mb20" style="padding-bottom: 20px">
					<center><h1>Overall Outstanding</h1></center>

					<table class="table table-bordered table-striped ">
						<thead>
							<tr>
								<th>
									Bill Id

								</th>
								<th>
									Customer Id

								</th>
								<th>
									Name

								</th>
								<th>
									Phone

								</th>

								<th>
									Bill Amount

								</th>
								<th>
									Advance

								</th>
								<th>
									Pending Amount

								</th>



								<th>
									Date

								</th>
							</tr>
						</thead>
						<tbody>
							{% for item  in data2 %}
							<tr>
								<td>{{item.Bill_Id}}</td>
								{% if item.Customer_Id %}
								   <td>{{item.Customer_Id}}</td>
								{% else %}
								  <td>{{item.Agent_Id}}</td>
								{% endif %}
								<td>{{item.Customer_Name}}</td>
								<td>{{item.Phone_No}}</td>
								<td>{{item.Grand_Total}}</td>
								<td>{{item.Paid_Amount}}</td>
								<td>{{item.Pending_Amount}}</td>
								<td>{{item.Date}}</td>
							</tr>
							{% endfor %}
						</tbody>
					</table>


				</div>

			</div>

			<!-- content-here -->
			<div class="content-container" id="content">
				<!-- dashboard page -->
				<div class="page page-dashboard">

					<div class="page-wrap">




					</div> <!-- #end page-wrap -->
				</div>
				<!-- #end dashboard page -->
			</div>


		</div> <!-- #end main-container -->


		<!-- theme settings -->
		<div class="site-settings clearfix hidden-xs">
			<div class="settings clearfix">
				<div class="trigger ion ion-settings left"></div>
				<div class="wrapper left">
					<ul class="list-unstyled other-settings">
						<li class="clearfix mb10">
							<div class="left small">Nav Horizontal</div>
							<div class="md-switch right">
								<label>
									<input type="checkbox" id="navHorizontal">
									<span>&nbsp;</span>
								</label>
							</div>


						</li>
						<li class="clearfix mb10">
							<div class="left small">Fixed Header</div>
							<div class="md-switch right">
								<label>
									<input type="checkbox" id="fixedHeader">
									<span>&nbsp;</span>
								</label>
							</div>
						</li>
						<li class="clearfix mb10">
							<div class="left small">Nav Full</div>
							<div class="md-switch right">
								<label>
									<input type="checkbox" id="navFull">
									<span>&nbsp;</span>
								</label>
							</div>
						</li>
					</ul>
					<hr />
					<ul class="themes list-unstyled" id="themeColor">
						<li data-theme="theme-zero"></li>
						<li data-theme="theme-one"></li>
						<li data-theme="theme-two"></li>
						<li data-theme="theme-three" class="active"></li>
						<li data-theme="theme-four"></li>
						<li data-theme="theme-five"></li>
						<li data-theme="theme-six"></li>
						<li data-theme="theme-seven"></li>
					</ul>
				</div>
			</div>
		</div>
		<!-- #end theme settings -->




		<!-- Dev only -->
		<!-- Vendors -->

		{% load static %}



		<script src="{% static 'scripts/vendors.js' %}"></script>


		<script src="{% static 'scripts/plugins/screenfull.js' %}"></script>
		<script src="{% static 'scripts/plugins/perfect-scrollbar.min.js' %}"></script>
		<script src="{% static 'scripts/plugins/waves.min.js' %}"></script>
		<script src="{% static 'scripts/plugins/jquery.dataTables.min.js' %}"></script>
		<script src="{% static 'scripts/app.js' %}"></script>

		

		<script>
			$(function () {
				"use strict";

				function initDataTable() {
					const $dataTable = $(".data-table");
					const $table = $dataTable.find("table");

					const datas = [
						{% for item in data %}
				{
					Bill_Id: "{{ item.Bill_Id|escapejs }}",
					Customer_Id: "{{ item.Customer_Id|escapejs }}",
					Customer_Name: "{{ item.Customer_Name|escapejs }}",
					Payment_Mode: "{{ item.Payment_Mode|escapejs }}",
					Grand_Total: "{{ item.Grand_Total|escapejs }}",
					Paid_Amount: "{{ item.Paid_Amount|escapejs }}",
					Pending_Amount: "{{ item.Pending_Amount|escapejs }}",
					Added_By: "{{ item.Added_By|escapejs }}",
					Payment_Date: "{{ item.Payment_Date|escapejs }}"
				} {% if not loop.last %}, {% endif %}
				{% endfor %}
			];

				const table = $table.DataTable({
					data: datas,
					columns: [
						{ data: "Bill_Id" },
						{ data: "Customer_Id" },
						{ data: "Customer_Name" },
						{ data: "Payment_Mode" },
						{ data: "Grand_Total" },
						{ data: "Paid_Amount" },
						{ data: "Pending_Amount" },
						{ data: "Added_By" },
						{ data: "Payment_Date" }
					],
					searching: true,
					dom: "rtip",
					pageLength: 10,
					order: [[0, "desc"]]
				});

				$dataTable.find(".searchInput").on("keyup", function () {
					table.search(this.value).draw();
				});

				$dataTable.find(".lengthSelect").on("change", function () {
					table.page.len(this.value).draw();
				});

				calculateTotals(datas);

				// Delete confirmation
				$(document).on("click", ".del-btn", function (e) {
					e.preventDefault();
					var deleteUrl = $(this).attr("href");
					if (confirm("Are you sure you want to delete this Item?")) {
						window.location.href = deleteUrl;
					}
				});
			}
		
		  function calculateTotals(data) {
					let upi = 0, cash = 0, discount = 0, cheque = 0, imps = 0;

					data.forEach(item => {

						let paid = parseFloat(item.Paid_Amount) || 0;
						let pending = parseFloat(item.Pending_Amount) || 0;

						let mode = (item.Payment_Mode || "").toLowerCase();
						if (mode === "upi") upi += paid;
						else if (mode === "cash") cash += paid;
						else if (mode === "discounted") discount += paid;
						else if (mode === "cheque") cheque += paid;
						else if (mode === "imps/nift") imps += paid;
					});


					$("#paid-upi").text(upi.toFixed(2));
					$("#paid-cash").text(cash.toFixed(2));
					$("#paid-discount").text(discount.toFixed(2));
					$("#paid-cheque").text(cheque.toFixed(2));
					$("#paid-IMPS").text(imps.toFixed(2));
				}
		  
		
		  function setupPrint() {
					$("#printTable").on("click", function () {
						const dataTable = $(".data-table table").DataTable();
						const allData = dataTable.rows().data(); // Get all rows, not just visible

				// Build table HTML manually
				let tableHTML = `
								<table>
								<thead>
									<tr>
									<th>Bill Id</th>
									<th>Customer Id</th>
									<th>Name</th>
									<th>Phone</th>
									<th>Bill Amount</th>
									<th>Advance</th>
									<th>Pending Amount</th>
									<th>Added By</th>
									<th>Date</th>
									</tr>
								</thead>
								<tbody>
							`;

				for (let i = 0; i < allData.length; i++) {
					const item = allData[i];
							tableHTML += `
									<tr>
										<td>${item.Bill_Id}</td>
										<td>${item.Customer_Id}</td>
										<td>${item.Customer_Name}</td>
										<td>${item.Phone_No}</td>
										<td>${item.Grand_Total}</td>
										<td>${item.Paid_Amount}</td>
										<td>${item.Pending_Amount}</td>
										<td>${item.Added_By}</td>
										<td>${item.Payment_Date}</td>
									</tr>
									`;
				}

						

				tableHTML += "</tbody></table>";

				// Build table HTML manually
				let tableHTML2 = `
								<table>
								<thead>
									<tr>
									<th>Bill Id</th>
									<th>Customer Id</th>
									<th>Customer Name</th>
									<th>Payment Mode</th>
									<th>Grand Total</th>
									<th>Paid Amount</th>
									<th>Pending Amount</th>
									<th>Added By</th>
									<th>Payment Date</th>
									</tr>
								</thead>
								<tbody>
							`;


					{% for item in data3 %}
							 tableHTML2 += `
									<tr>
										<td>{{item.Bill_Id}}</td>
										<td>{{item.Customer_Id}}</td>
										<td>{{item.Customer_Name}}</td>
										<td>{{item.Phone_No}}</td>
										<td>{{item.Grand_Total}}</td>
										<td>{{item.Paid_Amount}}</td>
										<td>{{item.Pending_Amount}}</td>
										<td>{{item.Added_By}}</td>
										<td>{{item.Date}}</td>
									</tr>
									`;
					{% endfor %}

						tableHTML2 += "</tbody></table>";

				// Build table HTML manually
				let tableHTML3 = `
								<table>
								<thead>
									<tr>
									<th>Bill Id</th>
									<th>Customer Id</th>
									<th>Customer Name</th>
									<th>Payment Mode</th>
									<th>Grand Total</th>
									<th>Paid Amount</th>
									<th>Pending Amount</th>
									<th>Added By</th>
									<th>Payment Date</th>
									</tr>
								</thead>
								<tbody>
							`;


					{% for item in data2 %}
							 tableHTML3 += `
									<tr>
										<td>{{item.Bill_Id}}</td>
										<td>{{item.Customer_Id}}</td>
										<td>{{item.Customer_Name}}</td>
										<td>{{item.Phone_No}}</td>
										<td>{{item.Grand_Total}}</td>
										<td>{{item.Paid_Amount}}</td>
										<td>{{item.Pending_Amount}}</td>
										<td>{{item.Added_By}}</td>
										<td>{{item.Date}}</td>
									</tr>
									`;
					{% endfor %}

						tableHTML3 += "</tbody></table>";

						// Clone totals HTML
						const totalsHTML = $(".totals-section").clone();
						const coloectionHTML = $(".total-collection.totals-section").clone();
						const coloectionHTML2 = $(".totals-section.total-business").clone();

						// Open new window for printing
						let win = window.open("", "", "height=700,width=900");
						win.document.write("<html><head><title>Print Bill Data</title>");
						win.document.write("<style>");
						win.document.write(`
				body { font-family: Arial; padding: 20px; }
				h2, h3 { margin-top: 20px; }
				table { width: 100%; border-collapse: collapse; margin-top: 10px; }
				th, td { border: 1px solid black; padding: 6px; text-align: left; }
				.totals-section { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; margin-top: 20px; font-size: 14px; }
				.totals-section h3 { background: none; box-shadow: none; padding: 6px; margin: 0; }
				.totals-section strong { color: #000; }
			  `);
						win.document.write("</style></head><body>");
						win.document.write("<h2>Bill Table</h2>");
						win.document.write(tableHTML);
						//win.document.write("<h3>Total Business</h3>");
						//win.document.write(totalsHTML.prop("outerHTML"));
						win.document.write("<h3>Total Collection</h3>");
						win.document.write(coloectionHTML.prop("outerHTML"));
						
						win.document.write("<h2>{{data4}} Bills</h2>");
						win.document.write(tableHTML2);
						win.document.write("<h3>Total Business</h3>");
						win.document.write(coloectionHTML2.prop("outerHTML"));
						
						win.document.write("<h2>Overall Outstanding</h2>");
						win.document.write(tableHTML3);
						win.document.write("</body></html>");
						win.document.close();
						win.print();
					});
				}
		  
		
		  function _init() {
					initDataTable();
					setupPrint();
				}
		
		  _init();
		});
		</script>



		<script>
			window.addEventListener("load", function () {
				const preloader = document.getElementById("preloader");
				preloader.style.opacity = "0";
				setTimeout(() => preloader.style.display = "none", 500);
			});
		</script>

</body>

</html>